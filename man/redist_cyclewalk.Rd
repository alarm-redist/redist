% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/redist_cyclewalk.R
\name{redist_cyclewalk}
\alias{redist_cyclewalk}
\title{CycleWalk MCMC Redistricting Sampler}
\usage{
redist_cyclewalk(
  map,
  nsims,
  chains = 1,
  warmup = 0,
  thin = 10L,
  cycle_walk_frac = 0.1,
  init_plan = NULL,
  counties = NULL,
  compactness = 1,
  constraints = list(),
  edge_weights = NULL,
  ncores = NULL,
  cl_type = "PSOCK",
  return_all = TRUE,
  init_name = NULL,
  verbose = FALSE,
  silent = FALSE
)
}
\arguments{
\item{map}{A \link{redist_map} object.}

\item{nsims}{The number of samples to draw per chain, not including warmup.}

\item{chains}{The number of parallel chains to run. Each chain will have
\code{nsims} draws. If \code{init_plan} is sampled, each chain will be initialized
with its own sampled plan. Defaults to 1.}

\item{warmup}{The number of warmup samples to discard.}

\item{thin}{Save every \code{thin}-th sample. Defaults to no thinning (1).}

\item{cycle_walk_frac}{Fraction of proposals that are cycle walks vs internal
forest walks (default 0.1). Cycle walks change the partition; forest walks
only change the spanning tree representation.}

\item{init_plan}{The initial state of the map, provided as a single vector
to be shared across all chains, or a matrix with \code{chains} columns.
If not provided, will default to the reference map of the \code{map} object, or if
none exists, will sample a random initial state using \link{redist_smc}. You can
also request a random initial state for each chain by setting
\code{init_plan="sample"}.}

\item{counties}{A vector containing county (or other administrative or
geographic unit) labels for each unit, which may be integers ranging from 1
to the number of counties, or a factor or character vector. If provided and
\code{edge_weights} is NULL, automatically creates edge weights that upweight
intra-county edges by 10x, encouraging plans that follow county lines.}

\item{compactness}{Controls the compactness of the generated districts, with
higher values preferring more compact districts. Must be nonnegative. A
value of 0 samples uniformly over partitions. Default is \code{0}.}

\item{constraints}{A \link{redist_constr} object or list of constraints.}

\item{edge_weights}{Edge weights for the graph. Can be:
\itemize{
\item A single number: used as the intra-county weight multiplier (requires
\code{counties}). For example, \code{edge_weights = 5} with \code{counties} upweights
intra-county edges by 5x.
\item A list of edge weight specifications, each with \code{edge} (length-2 vertex
indices) and \code{weight} (positive number). Unspecified edges default to 1.0.
\item NULL (default): if \code{counties} is provided, auto-generates 10x weights for
intra-county edges; otherwise no weighting.
}}

\item{ncores}{The number of parallel processes to run. Defaults to the
number of available cores, capped at the number of chains.}

\item{cl_type}{The cluster type (see \code{\link[parallel:makeCluster]{parallel::makeCluster()}}). Safest is \code{"PSOCK"},
but \code{"FORK"} may be appropriate in some settings.}

\item{return_all}{If \code{TRUE} return all sampled plans; otherwise, just return
the final plan from each chain.}

\item{init_name}{A name for the initial plan, or \code{FALSE} to not include
the initial plan in the output. Defaults to the column name of the
existing plan, or \verb{<init>} if the initial plan is sampled.}

\item{verbose}{Whether to print out intermediate information while sampling.}

\item{silent}{Whether to suppress all diagnostic information.}
}
\value{
A \link{redist_plans} object containing the simulated plans. If \code{chains > 1},
the output will include a \code{chain} column indicating which chain each plan
came from.
}
\description{
\code{redist_cyclewalk} uses a Markov Chain Monte Carlo algorithm based on
the CycleWalk method to generate redistricting plans. The algorithm maintains
a spanning forest representation of districts and proposes changes by finding
cycles between adjacent districts.
}
\details{
This function draws samples from a specific target measure, controlled by the
\code{map}, \code{compactness}, and \code{constraints} parameters.
}
\examples{
data(fl25)
fl_map <- redist_map(fl25, ndists = 3, pop_tol = 0.1)
sampled <- redist_cyclewalk(fl_map, 100)

# Multiple chains for convergence diagnostics
sampled_chains <- redist_cyclewalk(fl_map, 200, chains = 2, ncores = 2)

}
\concept{simulate}
