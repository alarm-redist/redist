<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Diagnostic information on sampled plans — summary.redist_plans • redist</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnostic information on sampled plans — summary.redist_plans"><meta name="description" content="Prints diagnostic information, which varies by algorithm. All algorithms
compute the plans_diversity() of the samples."><meta property="og:description" content="Prints diagnostic information, which varies by algorithm. All algorithms
compute the plans_diversity() of the samples."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">redist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/redist.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/common_args.html">Common Arguments to `redist` Functions</a></li>
    <li><a class="dropdown-item" href="../articles/flip.html">Redistricting with Flip MCMC</a></li>
    <li><a class="dropdown-item" href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/">redist 3.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alarm-redist/redist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Diagnostic information on sampled plans</h1>
      <small class="dont-index">Source: <a href="https://github.com/alarm-redist/redist/blob/main/R/diagnostics.R" class="external-link"><code>R/diagnostics.R</code></a></small>
      <div class="d-none name"><code>summary.redist_plans.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Prints diagnostic information, which varies by algorithm. All algorithms
compute the <code><a href="plans_diversity.html">plans_diversity()</a></code> of the samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'redist_plans'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, district <span class="op">=</span> <span class="fl">1L</span>, all_runs <span class="op">=</span> <span class="cn">TRUE</span>, vi_max <span class="op">=</span> <span class="fl">100</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <a href="redist_plans.html">redist_plans</a> object</p></dd>


<dt id="arg-district">district<a class="anchor" aria-label="anchor" href="#arg-district"></a></dt>
<dd><p>For R-hat values, which district to use for district-level
summary statistics. We strongly recommend calling <code><a href="match_numbers.html">match_numbers()</a></code> or
<code><a href="number_by.html">number_by()</a></code> before examining these district-level statistics.</p></dd>


<dt id="arg-all-runs">all_runs<a class="anchor" aria-label="anchor" href="#arg-all-runs"></a></dt>
<dd><p>When there are multiple SMC runs, show detailed summary
statistics for all runs (the default), or only the first run?</p></dd>


<dt id="arg-vi-max">vi_max<a class="anchor" aria-label="anchor" href="#arg-vi-max"></a></dt>
<dd><p>The maximum number of plans to sample in computing the pairwise
variation of information distance (sample diversity).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments (ignored)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing diagnostic information, invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For SMC and MCMC, if there are multiple runs/chains, R-hat values will be
computed for each summary statistic. These values should be close to 1.
If they are not, then there is too much between-chain variation, indicating
that there are not enough samples. R-hat values are calculated after
rank-normalization and folding.  MCMC chains are split in half before R-hat
is computed. For summary statistics that vary across districts, R-hat is
calculated for the first district only.</p>
<p>For SMC, diagnostics statistics include:</p><ul><li><p><strong>Effective samples</strong>: the effective sample size at each iteration, computed
using the SMC weights. Larger is better. The percentage in parentheses is the
ratio of the effective samples to the total samples.</p></li>
<li><p><strong>Acceptance rate</strong>: the fraction of drawn spanning trees which yield a valid
redistricting plan within the population tolerance. Very small values (&lt; 1%)
can indicate a bottleneck and may lead to a lack of diversity.</p></li>
<li><p><strong>Standard deviation of the log weights</strong>: More variable weights (larger s.d.)
indicate less efficient sampling. Values greater than 3 are likely problematic.</p></li>
<li><p><strong>Maximum unique plans:</strong> an upper bound on the number of unique redistricting
plans that survive each stage. The percentage in parentheses is the ratio of
this number to the total number of samples. Small values (&lt; 100) indicate a
bottleneck, which leads to a loss of sample diversity and a higher variance.</p></li>
<li><p><strong>Estimated <code>k</code> parameter</strong>: How many spanning tree edges were considered for
cutting at each split. Mostly informational, though large jumps may indicate
a need to increase <code>adapt_k_thresh</code>.</p></li>
<li><p><strong>Bottleneck</strong>: An asterisk will appear in the right column if a bottleneck
appears likely, based on the values of the other statistics.</p></li>
</ul><p>In the event of problematic diagnostics, the function will provide
suggestions for improvement.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iowa</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iowa_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">iowa</span>, ndists <span class="op">=</span> <span class="fl">4</span>, pop_tol <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plans</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">iowa_map</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEQUENTIAL MONTE CARLO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling 100 99-unit maps with 4 districts and population between 685430 and 837748.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plans</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">SMC:</span> 100 sampled plans of 4 districts on 99 units</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `adapt_k_thresh`=0.99 • `seq_alpha`=0.5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `pop_temper`=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plan diversity 80% range: 0.48 to 0.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sampling diagnostics for SMC run 1 of 1 (100 samples)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Eff. samples (%) Acc. rate Log wgt. sd  Max. unique Est. k </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Split 1        98 (97.9%)     19.5%        0.28    62 ( 98%)     16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Split 2        97 (96.7%)     28.2%        0.35    60 ( 95%)     10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Split 3        96 (95.7%)      9.5%        0.41    56 ( 89%)      8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resample       84 (83.6%)       NA%        0.41    82 (130%)     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #555555;"> Watch out for low effective samples, very low acceptance rates (less than</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">1%), large std. devs. of the log weights (more than 3 or so), and low numbers</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">of unique plans. R-hat values for summary statistics should be between 1 and</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">1.05.</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

