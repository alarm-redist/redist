<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Inverse probability reweighting for MCMC Redistricting — redist.ipw • redist</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inverse probability reweighting for MCMC Redistricting — redist.ipw"><meta name="description" content="redist.ipw properly weights and resamples simulated redistricting plans
so that the set of simulated plans resemble a random sample from the
underlying distribution. redist.ipw is used to correct the sample when
population parity, geographic compactness, or other constraints are
implemented."><meta property="og:description" content="redist.ipw properly weights and resamples simulated redistricting plans
so that the set of simulated plans resemble a random sample from the
underlying distribution. redist.ipw is used to correct the sample when
population parity, geographic compactness, or other constraints are
implemented."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">redist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/redist.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/common_args.html">Common Arguments to `redist` Functions</a></li>
    <li><a class="dropdown-item" href="../articles/flip.html">Redistricting with Flip MCMC</a></li>
    <li><a class="dropdown-item" href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/">redist 3.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alarm-redist/redist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Inverse probability reweighting for MCMC Redistricting</h1>
      <small class="dont-index">Source: <a href="https://github.com/alarm-redist/redist/blob/main/R/flip_helpers.R" class="external-link"><code>R/flip_helpers.R</code></a></small>
      <div class="d-none name"><code>redist.ipw.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>redist.ipw</code> properly weights and resamples simulated redistricting plans
so that the set of simulated plans resemble a random sample from the
underlying distribution. <code>redist.ipw</code> is used to correct the sample when
population parity, geographic compactness, or other constraints are
implemented.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">redist.ipw</span><span class="op">(</span></span>
<span>  <span class="va">plans</span>,</span>
<span>  resampleconstraint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pop_dev"</span>, <span class="st">"edges_removed"</span>, <span class="st">"segregation"</span>, <span class="st">"status_quo"</span><span class="op">)</span>,</span>
<span>  <span class="va">targetbeta</span>,</span>
<span>  targetpop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  temper <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-plans">plans<a class="anchor" aria-label="anchor" href="#arg-plans"></a></dt>
<dd><p>An object of class <code>redist_plans</code> from <code><a href="redist_flip.html">redist_flip()</a></code>.</p></dd>


<dt id="arg-resampleconstraint">resampleconstraint<a class="anchor" aria-label="anchor" href="#arg-resampleconstraint"></a></dt>
<dd><p>The constraint implemented in the simulations: one
of "pop", "compact", "segregation", or "similar".</p></dd>


<dt id="arg-targetbeta">targetbeta<a class="anchor" aria-label="anchor" href="#arg-targetbeta"></a></dt>
<dd><p>The target value of the constraint.</p></dd>


<dt id="arg-targetpop">targetpop<a class="anchor" aria-label="anchor" href="#arg-targetpop"></a></dt>
<dd><p>The desired level of population parity. <code>targetpop</code> =
0.01 means that the desired distance from population parity is 1%. The
default is <code>NULL</code>.</p></dd>


<dt id="arg-temper">temper<a class="anchor" aria-label="anchor" href="#arg-temper"></a></dt>
<dd><p>A flag for whether simulated tempering was used to improve the
mixing of the Markov Chain. The default is <code>1</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>redist.ipw</code> returns an object of class "redist". The object
<code>redist</code> is a list that contains the following components (the
inclusion of some components is dependent on whether tempering
techniques are used):</p>
<dl><dt>plans</dt>
<dd><p>Matrix of congressional district assignments generated by the
algorithm. Each row corresponds to a geographic unit, and each column
corresponds to a simulation.</p></dd>

<dt>distance_parity</dt>
<dd><p>Vector containing the maximum distance from parity for
a particular simulated redistricting plan.</p></dd>

<dt>mhdecisions</dt>
<dd><p>A vector specifying whether a proposed redistricting plan
was accepted (1) or rejected (0) in a given iteration.</p></dd>

<dt>mhprob</dt>
<dd><p>A vector containing the Metropolis-Hastings acceptance
probability for each iteration of the algorithm.</p></dd>

<dt>pparam</dt>
<dd><p>A vector containing the draw of the <code>p</code> parameter for each
simulation, which dictates the number of swaps attempted.</p></dd>

<dt>constraint_pop</dt>
<dd><p>A vector containing the value of the population
constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_compact</dt>
<dd><p>A vector containing the value of the compactness
constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_segregation</dt>
<dd><p>A vector containing the value of the
segregation constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_similar</dt>
<dd><p>A vector containing the value of the similarity
constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_vra</dt>
<dd><p>A vector containing the value of the
vra constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_partisan</dt>
<dd><p>A vector containing the value of the
partisan constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_minority</dt>
<dd><p>A vector containing the value of the
minority constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_hinge</dt>
<dd><p>A vector containing the value of the
hinge constraint for each accepted redistricting plan.</p></dd>

<dt>constraint_qps</dt>
<dd><p>A vector containing the value of the
QPS constraint for each accepted redistricting plan.</p></dd>

<dt>beta_sequence</dt>
<dd><p>A vector containing the value of beta for each iteration
of the algorithm. Returned when tempering is being used.</p></dd>

<dt>mhdecisions_beta</dt>
<dd><p>A vector specifying whether a proposed beta value was
accepted (1) or rejected (0) in a given iteration of the algorithm. Returned
when tempering is being used.</p></dd>

<dt>mhprob_beta</dt>
<dd><p>A vector containing the Metropolis-Hastings acceptance
probability for each iteration of the algorithm. Returned when tempering
is being used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function allows users to resample redistricting plans using
inverse probability weighting techniques described in Rubin (1987). This
techniques reweights and resamples redistricting plans so that the resulting
sample is representative of a random sample from the uniform distribution.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fifield, Benjamin, Michael Higgins, Kosuke Imai and Alexander
Tarr. (2016) "A New Automated Redistricting Simulator Using Markov Chain
Monte Carlo." Working Paper.
Available at <a href="http://imai.princeton.edu/research/files/redist.pdf" class="external-link">http://imai.princeton.edu/research/files/redist.pdf</a>.</p>
<p>Rubin, Donald. (1987) "Comment: A Noniterative Sampling/Importance Resampling
Alternative to the Data Augmentation Algorithm for Creating a Few Imputations
when Fractions of Missing Information are Modest: the SIR Algorithm."
Journal of the American Statistical Association.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iowa</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">map_ia</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">iowa</span>, existing_plan <span class="op">=</span> <span class="va">cd_2010</span>, pop_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cons</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_constr.html">redist_constr</a></span><span class="op">(</span><span class="va">map_ia</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cons</span> <span class="op">&lt;-</span> <span class="fu"><a href="constraints.html">add_constr_pop_dev</a></span><span class="op">(</span><span class="va">cons</span>, strength <span class="op">=</span> <span class="fl">5.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alg</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_flip.html">redist_flip</a></span><span class="op">(</span><span class="va">map_ia</span>, nsims <span class="op">=</span> <span class="fl">500</span>, constraints <span class="op">=</span> <span class="va">cons</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="color: #BB0000; font-weight: bold;">redist_flip()</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="color: #BB0000; font-weight: bold;">Automated Redistricting Simulation Using Markov Chain Monte Carlo</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Preprocessing data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Starting swMH().</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">■                               </span>   0% | ETA: 1s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s | MH Acceptance: 0.96</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">alg_ipw</span> <span class="op">&lt;-</span> <span class="fu">redist.ipw</span><span class="op">(</span>plans <span class="op">=</span> <span class="va">alg</span>,</span></span>
<span class="r-in"><span>    resampleconstraint <span class="op">=</span> <span class="st">"pop_dev"</span>,</span></span>
<span class="r-in"><span>    targetbeta <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    targetpop <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

