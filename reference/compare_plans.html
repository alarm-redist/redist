<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make a comparison between two sets of plans — compare_plans • redist</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a comparison between two sets of plans — compare_plans"><meta name="description" content="This function provides one way to identify the structural differences between
two sets of redistricting plans. It operates by computing the precinct
co-occurrence matrix (a symmetric matrix where the i,j-th entry is the
fraction of plans where precinct i and j are in the same district) for each
set, and then computing the first eigenvalue of the difference in these two
matrices (in each direction). These eigenvalues identify the important parts
of the map."><meta property="og:description" content="This function provides one way to identify the structural differences between
two sets of redistricting plans. It operates by computing the precinct
co-occurrence matrix (a symmetric matrix where the i,j-th entry is the
fraction of plans where precinct i and j are in the same district) for each
set, and then computing the first eigenvalue of the difference in these two
matrices (in each direction). These eigenvalues identify the important parts
of the map."><meta property="og:image" content="http://alarm-redist.org/redist/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">redist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/redist.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/common_args.html">Common Arguments to `redist` Functions</a></li>
    <li><a class="dropdown-item" href="../articles/flip.html">Redistricting with Flip MCMC</a></li>
    <li><a class="dropdown-item" href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/">redist 3.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alarm-redist/redist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Make a comparison between two sets of plans</h1>
      <small class="dont-index">Source: <a href="https://github.com/alarm-redist/redist/blob/v4.3.1/R/classify_compare.R" class="external-link"><code>R/classify_compare.R</code></a></small>
      <div class="d-none name"><code>compare_plans.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides one way to identify the structural differences between
two sets of redistricting plans. It operates by computing the precinct
co-occurrence matrix (a symmetric matrix where the i,j-th entry is the
fraction of plans where precinct i and j are in the same district) for each
set, and then computing the first eigenvalue of the difference in these two
matrices (in each direction). These eigenvalues identify the important parts
of the map.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compare_plans</span><span class="op">(</span></span>
<span>  <span class="va">plans</span>,</span>
<span>  <span class="va">set1</span>,</span>
<span>  <span class="va">set2</span>,</span>
<span>  shp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Set 1"</span>, <span class="st">"Set 2"</span><span class="op">)</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-plans">plans<a class="anchor" aria-label="anchor" href="#arg-plans"></a></dt>
<dd><p>a <a href="redist_plans.html">redist_plans</a> object</p></dd>


<dt id="arg-set-">set1<a class="anchor" aria-label="anchor" href="#arg-set-"></a></dt>
<dd><p><code><a href="https://dplyr.tidyverse.org/reference/dplyr_data_masking.html" class="external-link">&lt;data-masking&gt;</a></code> indexing vectors
for the plan draws to compare.  Alternatively, a second <a href="redist_plans.html">redist_plans</a>
object to compare to.</p></dd>


<dt id="arg-set-">set2<a class="anchor" aria-label="anchor" href="#arg-set-"></a></dt>
<dd><p><code><a href="https://dplyr.tidyverse.org/reference/dplyr_data_masking.html" class="external-link">&lt;data-masking&gt;</a></code> indexing vectors
for the plan draws to compare. Must be mutually exclusive with <code>set1</code>.</p></dd>


<dt id="arg-shp">shp<a class="anchor" aria-label="anchor" href="#arg-shp"></a></dt>
<dd><p>a shapefile for plotting.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>If <code>plot="line"</code>, display a plot for each set showing the set of
boundaries which most distinguish it from the other set (the squared
differences in the eigenvector values across the boundary).  If
<code>plot="fill"</code>, plot the eigenvector for each set as a choropleth. If <code>plot = 'adj'</code>,
plot the shows the adjacency graph edges which most distinguish it from the other set.
The adj option is a different graphical option of the same information as the line
option. See below for more information.  Set to <code>FALSE</code> to disable plotting
(or leave out <code>shp</code>).</p></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>the value to threshold the eigenvector at in determining the
relevant set of precincts for comparison.</p></dd>


<dt id="arg-labs">labs<a class="anchor" aria-label="anchor" href="#arg-labs"></a></dt>
<dd><p>the names of the panels in the plot.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>the number of parallel cores to use.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If possible, makes a comparison plot according to <code>plot</code>. Otherwise
returns the following list:</p>
<dl><dt>eigen1</dt>
<dd><p>A numeric vector containing the first eigenvector of
<code>p1 - p2</code>, where <code>p1</code> and <code>p2</code> are the co-occurrence matrices
for <code>set1</code> and <code>set2</code>, respectively.</p></dd>

<dt>eigen2</dt>
<dd><p>A numeric vector containing the first eigenvector of
<code>p2 - p1</code>, where <code>p1</code> and <code>p2</code> are the co-occurrence matrices
for <code>set1</code> and <code>set2</code>, respectively.</p></dd>

<dt>group_1a, group_1b</dt>
<dd><p>Lists of precincts. Compared to <code>set2</code>, in the
<code>set1</code> plans these precincts were much more likely to be in separate
districts. Computed by thresholding <code>eigen1</code> at <code>thresh</code>.</p></dd>

<dt>group_2a, group_2b</dt>
<dd><p>Lists of precincts. Compared to <code>set1</code>, in the
<code>set2</code> plans these precincts were much more likely to be in separate
districts. Computed by thresholding <code>eigen2</code> at <code>thresh</code>.</p></dd>

<dt>cooccur_sep_1</dt>
<dd><p>The difference in the average co-occurrence of precincts
in <code>group_1a</code> and <code>group_1b</code> between <code>set2</code> and <code>set1</code>.
Higher indicates better separation.</p></dd>

<dt>cooccur_sep_2</dt>
<dd><p>The difference in the average co-occurrence of precincts
in <code>group_2a</code> and <code>group_2b</code> between <code>set1</code> and <code>set2</code>.
Higher indicates better separation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The co-occurrence matrices are regularized with a \(Beta(1/ndists, 1-1/ndists)\)
prior, which is useful for when either <code>set1</code> or <code>set2</code> is small.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iowa</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iowa_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">iowa</span>, ndists <span class="op">=</span> <span class="fl">4</span>, pop_tol <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plans1</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">iowa_map</span>, <span class="fl">100</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plans2</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_mergesplit.html">redist_mergesplit</a></span><span class="op">(</span><span class="va">iowa_map</span>, <span class="fl">200</span>, warmup <span class="op">=</span> <span class="fl">100</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">compare_plans</span><span class="op">(</span><span class="va">plans1</span>, <span class="va">plans2</span>, shp <span class="op">=</span> <span class="va">iowa_map</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="compare_plans-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">compare_plans</span><span class="op">(</span><span class="va">plans2</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">draw</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">draw</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">20</span>, shp <span class="op">=</span> <span class="va">iowa_map</span>, plot <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="compare_plans-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

