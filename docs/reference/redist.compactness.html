<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate compactness measures for a set of plans — distr_compactness • redist</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate compactness measures for a set of plans — distr_compactness"><meta name="description" content="redist.compactness is used to compute different compactness statistics for a
shapefile. It currently computes the Polsby-Popper, Schwartzberg score, Length-Width Ratio,
Convex Hull score, Reock score, Boyce Clark Index, Fryer Holden score, Edges Removed number,
and the log of the Spanning Trees."><meta property="og:description" content="redist.compactness is used to compute different compactness statistics for a
shapefile. It currently computes the Polsby-Popper, Schwartzberg score, Length-Width Ratio,
Convex Hull score, Reock score, Boyce Clark Index, Fryer Holden score, Edges Removed number,
and the log of the Spanning Trees."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">redist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/redist.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/common_args.html">Common Arguments to `redist` Functions</a></li>
    <li><a class="dropdown-item" href="../articles/flip.html">Redistricting with Flip MCMC</a></li>
    <li><a class="dropdown-item" href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/">redist 3.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alarm-redist/redist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate compactness measures for a set of plans</h1>
      <small class="dont-index">Source: <a href="https://github.com/alarm-redist/redist/blob/HEAD/R/tidy_deprecations.R" class="external-link"><code>R/tidy_deprecations.R</code></a>, <a href="https://github.com/alarm-redist/redist/blob/HEAD/R/deprecations.R" class="external-link"><code>R/deprecations.R</code></a></small>
      <div class="d-none name"><code>redist.compactness.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>redist.compactness</code> is used to compute different compactness statistics for a
shapefile. It currently computes the Polsby-Popper, Schwartzberg score, Length-Width Ratio,
Convex Hull score, Reock score, Boyce Clark Index, Fryer Holden score, Edges Removed number,
and the log of the Spanning Trees.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">distr_compactness</span><span class="op">(</span><span class="va">map</span>, measure <span class="op">=</span> <span class="st">"FracKept"</span>, .data <span class="op">=</span> <span class="fu">cur_plans</span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">redist.compactness</span><span class="op">(</span></span>
<span>  shp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">plans</span>,</span>
<span>  measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PolsbyPopper"</span><span class="op">)</span>,</span>
<span>  total_pop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  draw <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  counties <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  planarize <span class="op">=</span> <span class="fl">3857</span>,</span>
<span>  <span class="va">ppRcpp</span>,</span>
<span>  <span class="va">perim_path</span>,</span>
<span>  <span class="va">perim_df</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>a <code><a href="redist_map.html">redist_map</a></code> object</p></dd>


<dt id="arg-measure">measure<a class="anchor" aria-label="anchor" href="#arg-measure"></a></dt>
<dd><p>A vector with a string for each measure desired. "PolsbyPopper",
"Schwartzberg", "LengthWidth", "ConvexHull", "Reock", "BoyceClark", "FryerHolden",
"EdgesRemoved", "FracKept", and "logSpanningTree" are implemented. Defaults to "PolsbyPopper". Use "all" to
return all implemented measures.</p></dd>


<dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>a <code><a href="redist_plans.html">redist_plans</a></code> object</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed on to <code>redist.compactness</code></p></dd>


<dt id="arg-shp">shp<a class="anchor" aria-label="anchor" href="#arg-shp"></a></dt>
<dd><p>A SpatialPolygonsDataFrame or sf object. Required unless "EdgesRemoved"
and "logSpanningTree" with adjacency provided.</p></dd>


<dt id="arg-plans">plans<a class="anchor" aria-label="anchor" href="#arg-plans"></a></dt>
<dd><p>A numeric vector (if only one map) or matrix with one row
for each precinct and one column for each map. Required.</p></dd>


<dt id="arg-total-pop">total_pop<a class="anchor" aria-label="anchor" href="#arg-total-pop"></a></dt>
<dd><p>A numeric vector with the population for every observation. Is
only necessary when "FryerHolden" is used for measure. Defaults to NULL.</p></dd>


<dt id="arg-adj">adj<a class="anchor" aria-label="anchor" href="#arg-adj"></a></dt>
<dd><p>A zero-indexed adjacency list. Only used for "PolsbyPopper",
EdgesRemoved" and "logSpanningTree". Created with <code>redist.adjacency</code> if not
supplied and needed. Default is NULL.</p></dd>


<dt id="arg-draw">draw<a class="anchor" aria-label="anchor" href="#arg-draw"></a></dt>
<dd><p>A numeric to specify draw number. Defaults to 1 if only one map provided
and the column number if multiple maps given. Can also take a factor input, which will become the
draw column in the output if its length matches the number of entries in plans. If the <code>plans</code> input
is a <code>redist_plans</code> object, it extracts the <code>draw</code> identifier.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Number of cores to use for parallel computing. Default is 1.</p></dd>


<dt id="arg-counties">counties<a class="anchor" aria-label="anchor" href="#arg-counties"></a></dt>
<dd><p>A numeric vector from 1:ncounties corresponding to counties. Required for "logSpanningTree".</p></dd>


<dt id="arg-planarize">planarize<a class="anchor" aria-label="anchor" href="#arg-planarize"></a></dt>
<dd><p>a number, indicating the CRS to project the shapefile to if
it is latitude-longitude based. Set to FALSE to avoid planarizing.</p></dd>


<dt id="arg-pprcpp">ppRcpp<a class="anchor" aria-label="anchor" href="#arg-pprcpp"></a></dt>
<dd><p>Boolean, whether to run Polsby Popper and Schwartzberg using Rcpp.
It has a higher upfront cost, but quickly becomes faster.
Becomes TRUE if ncol(district_membership &gt; 8) and not manually set.</p></dd>


<dt id="arg-perim-path">perim_path<a class="anchor" aria-label="anchor" href="#arg-perim-path"></a></dt>
<dd><p>it checks for an Rds, if no rds exists at the path,
it creates an rds with borders and saves it.
This can be created in advance with <code><a href="http://alarm-redist.org/redistmetrics/reference/prep_perims.html" class="external-link">redistmetrics::prep_perims()</a></code>.</p></dd>


<dt id="arg-perim-df">perim_df<a class="anchor" aria-label="anchor" href="#arg-perim-df"></a></dt>
<dd><p>A dataframe output from <code><a href="http://alarm-redist.org/redistmetrics/reference/prep_perims.html" class="external-link">redistmetrics::prep_perims()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with a column that specifies the district, a column for
each specified measure, and a column that specifies the map number.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function computes specified compactness scores for a map.  If
there is more than one shape specified for a single district, it combines
them, if necessary, and computes one score for each district.</p>
<p>Polsby-Popper is computed as $$\frac{4*\pi*A(d)}{P(d)^2}$$ where A is the area
function, the district is d, and P is the perimeter function. All  values are between
0 and 1, where larger values are more compact.</p>
<p>Schwartzberg is computed as $$\frac{P(d)}{2*\pi*\sqrt{\frac{A(d)}{\pi}}}$$
where A is the area function, the district is d, and P is the perimeter function.
All  values are between 0 and 1, where larger values are more compact.</p>
<p>The Length Width ratio is computed as $$\frac{length}{width}$$ where length
is the shorter of the maximum x distance and the maximum y distance. Width is
the longer of the two values. All  values are between 0 and 1, where larger
values are more compact.</p>
<p>The Convex Hull score is computed as $$\frac{A(d)}{A(CVH)}$$ where A is the area
function, d is the district, and CVH is the convex hull of the district. All
values are between 0 and 1, where larger values are more compact.</p>
<p>The Reock score is computed as $$\frac{A(d)}{A(MBC)}$$ where A is the area
function, d is the district, and MBC is the minimum bounding circle of the
district. All values are between 0 and 1, where larger values are more compact.</p>
<p>The Boyce Clark Index is computed as $$1 - \sum_{1}^{16}\{\frac{|\frac{r_i}{\sum_ir_i}*100-6.25 |\}}{200}$$.
The \(r_i\) are the distances of the 16 radii computed from the geometric
centroid of the shape to the most outward point of the shape that intersects
the radii, if the centroid is contained within the shape.  If the centroid
lies outside of the shape, a point on the surface is used, which will naturally
incur a penalty to the score. All  values are between 0 and 1,
where larger values are more compact.</p>
<p>The Fryer Holden score for each district is computed with $$Pop\odot D(precinct)^2$$,
where \(Pop\) is the population product matrix.  Each element is the
product of the i-th and j-th precinct's populations.  D represents the distance,
where the matrix is the distance between each precinct.  To fully compute this
index, for any map, the sum of these values should be used as the numerator.
The denominator can be calculated from the full enumeration of districts as the
smallest calculated numerator. This produces very large numbers, where smaller
values are more compact.</p>
<p>The log spanning tree measure is the logarithm of the product of the
number of spanning trees which can be drawn on each district.</p>
<p>The edges removed measure is number of edges removed from the underlying adjacency graph.
A smaller number of edges removed is more compact.</p>
<p>The fraction kept measure is the fraction of edges that were not removed from the
underlying adjacency graph. This takes values 0 - 1, where 1 is more compact.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Boyce, R., &amp; Clark, W. 1964. The Concept of Shape in Geography.
Geographical Review, 54(4), 561-572.</p>
<p>Cox, E. 1927. A Method of Assigning Numerical and Percentage Values to the
Degree of Roundness of Sand Grains. Journal of Paleontology, 1(3), 179-183.</p>
<p>Fryer R, Holden R. 2011. Measuring the Compactness of Political Districting Plans.
Journal of Law and Economics.</p>
<p>Harris, Curtis C. 1964. “A scientific method of districting”.
Behavioral Science 3(9), 219–225.</p>
<p>Maceachren, A. 1985. Compactness of Geographic Shape: Comparison and
Evaluation of Measures. Geografiska Annaler. Series B, Human Geography, 67(1),
53-67.</p>
<p>Polsby, Daniel D., and Robert D. Popper. 1991. “The Third Criterion:
Compactness as a procedural safeguard against partisan gerrymandering.”
Yale Law &amp; Policy Review 9 (2): 301–353.</p>
<p>Reock, E. 1961. A Note: Measuring Compactness as a Requirement of Legislative
Apportionment. Midwest Journal of Political Science, 5(1), 70-74.</p>
<p>Schwartzberg, Joseph E. 1966. Reapportionment, Gerrymanders, and the Notion
of Compactness. Minnesota Law Review. 1701.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fl25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fl25_enum</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">plans_05</span> <span class="op">&lt;-</span> <span class="va">fl25_enum</span><span class="op">$</span><span class="va">plans</span><span class="op">[</span>, <span class="va">fl25_enum</span><span class="op">$</span><span class="va">pop_dev</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># old redist.compactness(</span></span></span>
<span class="r-in"><span><span class="co">#     shp = fl25, plans = plans_05[, 1:3],</span></span></span>
<span class="r-in"><span><span class="co">#     measure = c("PolsbyPopper", "EdgesRemoved")</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="fu"><a href="http://alarm-redist.org/redistmetrics/reference/comp_polsby.html" class="external-link">comp_polsby</a></span><span class="op">(</span><span class="va">plans_05</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fl25</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3973494 0.2458002 0.2347778 0.2844531 0.1274875 0.2347778 0.3712206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.2337005 0.2072902</span>
<span class="r-in"><span><span class="fu"><a href="http://alarm-redist.org/redistmetrics/reference/comp_edges_rem.html" class="external-link">comp_edges_rem</a></span><span class="op">(</span><span class="va">plans_05</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fl25</span>, <span class="va">fl25</span><span class="op">$</span><span class="va">adj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0 0 0 0 0 0 0 0</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

